<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<script src="http://localhost:8080/webjars/jquery/3.3.1/jquery.min.js"></script>
<head>
<meta charset="UTF-8">
<title>St.Thyme's Online Library</title>
<style type="text/css">
label {
	display: inline-block;
	width: 130px;
	text-align: center;
	vertical-align: top;
}

input {
	width: 500px;
}

.row {
	margin-top: 20px;
}

select {
	width: 200px;
	height: 50px;
}

button {
	width: 200px;
}
</style>
</head>
<body>
	<h1>Онлайн-библиотека имени Св.Тимьяна Неизвестного</h1>
	<h1>
		<span style="font-size: 18px;">Изменение книги</span>
	</h1>
	<form id="create-form" th:action="@{/}" th:method="post" action="book_edit.html">
		<div class="row">
			<label for="holder-input">Название:</label> 
			<input id="holder-input" name="bookName" type="text" th:value="Название" value="Война и Мир" />
		</div>
		<div class="row">
			<label for="authors-select">Авторы:</label> 
			<select multiple id="authors-select" name="authors">
				<option th:each="author : ${authorList}" th:text="${author.toString()}" th:value="${author.id}">Толстой Лев Николаевич</option>
			</select>
		</div>
		<div class="row">
			<label for="genres-select">Жанры:</label> 
			<select multiple id="genres-select" name="genres">
				<option th:each="genre : ${genreList}" th:text="${genre.toString()}" th:value="${genre.toString()}">Философский роман</option>
			</select>
		</div>
		
		<div class="row">
			<button type="submit" id="save" name="button" value ="save">Сохранить</button>
		</div>
		<div class="row">
			<button type="submit" id="delete" name="button" value ="delete">Удалить</button>
		</div>
		<input id="bookId" name="id" type="text" th:value=${id} hidden="true"/>
	</form>
	<script>
	$(function () 
		{	
		$.get('/api/edit/'+ $('input#bookId').val()).done(function(book){
			$('input#holder-input').val(book.bookName);
			book.authors.forEach(function(author){
				$('select#authors-select option[value='+author.id+']').prop('selected', true);});
			book.genres.forEach(function(genre){
				$('select#genres-select option[value='+genre.genreName+']').prop('selected', true);});			
			});
         });
   </script>
</body>
</html>